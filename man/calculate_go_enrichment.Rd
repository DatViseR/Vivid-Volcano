% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vivid_functions.R
\name{calculate_go_enrichment}
\alias{calculate_go_enrichment}
\title{Calculate GO Enrichment}
\usage{
calculate_go_enrichment(
  genes,
  go_categories,
  go_data,
  log_messages_rv,
  log_event
)
}
\arguments{
\item{genes}{Vector or list of gene identifiers to analyze}

\item{go_categories}{Vector of GO category names to test for enrichment}

\item{go_data}{Data frame containing GO annotations with columns 'name' (GO category) 
and 'gene' (gene identifier)}

\item{log_messages_rv}{Reactive value for storing log messages}

\item{log_event}{Logging function created by create_logger()}
}
\value{
A data frame containing enrichment analysis results with columns:
  \itemize{
    \item GO_Category: Name of the GO category
    \item P_Value: Unadjusted p-value from hypergeometric test
    \item Adjusted_P_Value: Bonferroni-corrected p-value (n=1160)
    \item Population_Size: Total number of genes in background (19689 human coding genes)
    \item Success_Population_Size: Number of genes in the GO category
    \item Sample_Size: Number of input genes after cleaning
    \item Sample_Success_Size: Number of input genes found in the GO category
  }
}
\description{
Performs Gene Ontology (GO) enrichment analysis using hypergeometric testing
on a set of input genes. Includes comprehensive logging of the analysis process and
applies Bonferroni correction for multiple testing. This function is used in the Draw VOlcano module,
but not in the GSEA module which uses identify_top_enriched_GO_enrichment instead.
}
\details{
Calculate Gene Ontology Enrichment Analysis


The function performs these steps:
1. Cleans and standardizes input gene names
2. Processes each GO category separately
3. Performs hypergeometric testing for enrichment
4. Applies Bonferroni correction for multiple testing

The background population is set to 19,689 genes (human coding genes excluding pseudogenes).
Bonferroni correction uses n=1160 (estimate for level 4 hierarchy GO tags).
}
\note{
The function uses a fixed background population size of 19,689 genes and 
applies Bonferroni correction with n=1160. These values may need adjustment
based on your specific analysis context. This function is used in the Draw VOlcano module,
but not in the GSEA module which uses identify_top_enriched_GO_enrichmentinstead.
}
\examples{
\dontrun{
# In Shiny server context
server <- function(input, output, session) {
  log_messages <- reactiveVal("")
  logger <- create_logger(session)
  
  # Example input data
  genes <- c("BRCA1", "BRCA2", "TP53", "PTEN")
  go_cats <- c("DNA repair", "cell cycle", "apoptosis")
  go_data <- data.frame(
    name = c("DNA repair", "DNA repair", "cell cycle"),
    gene = c("BRCA1", "BRCA2", "TP53")
  )
  
  # Calculate enrichment
  results <- calculate_go_enrichment(
    genes, 
    go_cats, 
    go_data, 
    log_messages, 
    logger
  )
}
}

}
\seealso{
\code{\link{clean_gene_names}} for gene name preprocessing
\code{\link{perform_hypergeometric_test}} for statistical testing
}
